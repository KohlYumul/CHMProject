{% extends "base.html" %}
{% block content %}
<div class="form-container">
    <h2>üë®‚Äç‚öïÔ∏è Create Admin or Staff Account</h2>
    <form method="post" class="form text-center">
        {% csrf_token %}
        <div class="form-group">
            {{ form.email.label_tag }}
            {{ form.email }}
        </div>
        <div class="form-group">
            {{ form.first_name.label_tag }}
            {{ form.first_name }}
        </div>
        <div class="form-group">
            {{ form.last_name.label_tag }}
            {{ form.last_name }}
        </div>
        <div class="form-group">
            {{ form.role.label_tag }}
            {{ form.role }}
        </div>
        <div class="form-group" id="hospital-field" style="display:none;">
            {{ form.hospital.label_tag }}
            {{ form.hospital }}
        </div>
        <div class="form-group">
            {{ form.password1.label_tag }}
            {{ form.password1 }}
        </div>
        <div class="form-group">
            {{ form.password2.label_tag }}
            {{ form.password2 }}
        </div>

        <div class="form-actions">
            <button type="submit" class="btn btn-primary">Create Account</button>
            <a href="{% url 'accounts:admin_dashboard' %}" class="btn btn-secondary">Return to Dashboard</a>
        </div>
    </form>
</div>

{% if account_created %}
<script>
    document.addEventListener("DOMContentLoaded", function() {
        alert("Admin/Staff account created successfully!");
        window.location.href = "{{ redirect_url }}";
    });
</script>
{% endif %}

<script>
document.addEventListener("DOMContentLoaded", function () {
    const roleField = document.getElementById("id_role");
    const hospitalFieldDiv = document.getElementById("hospital-field");
    const hospitalSelect = document.getElementById("id_hospital");

    function toggleHospitalField() {
        if (roleField.value === "Staff") {
            hospitalFieldDiv.style.display = "block";
            hospitalSelect.required = true;
        } else {
            hospitalFieldDiv.style.display = "none";
            hospitalSelect.required = false;
            hospitalSelect.value = "";
        }
    }

    toggleHospitalField();
    roleField.addEventListener("change", toggleHospitalField);
});
</script>
{% endblock %}
